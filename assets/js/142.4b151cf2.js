(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{517:function(a,e,t){"use strict";t.r(e);var s=t(9),v=Object(s.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"kafka集群安装文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kafka集群安装文档"}},[a._v("#")]),a._v(" Kafka集群安装文档")]),a._v(" "),e("h2",{attrs:{id:"概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),e("p",[a._v("本文提供了在CentOS 7上安装和配置Kafka集群的指南。其中包括安装Java JDK 11、下载和解压Zookeeper和Kafka、\n配置Zookeeper集群和Kafka集群、启动集群以及验证集群的步骤。建议进行更详细的配置和安全性设置，并使用适当的集群规模和复制因子来确保高可用性和数据冗余。")]),a._v(" "),e("h2",{attrs:{id:"你将获得"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#你将获得"}},[a._v("#")]),a._v(" 你将获得")]),a._v(" "),e("ul",[e("li",[a._v("安装Java JDK 11")]),a._v(" "),e("li",[a._v("下载和解压Zookeeper和Kafka")]),a._v(" "),e("li",[a._v("配置Zookeeper集群和Kafka集群")]),a._v(" "),e("li",[a._v("启动Kafka集群")]),a._v(" "),e("li",[a._v("验证Kafka集群")])]),a._v(" "),e("h2",{attrs:{id:"步骤1-准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤1-准备工作"}},[a._v("#")]),a._v(" 步骤1：准备工作")]),a._v(" "),e("p",[a._v("在开始安装之前，请确保满足以下先决条件：")]),a._v(" "),e("ul",[e("li",[a._v("CentOS 7操作系统")]),a._v(" "),e("li",[a._v("Java JDK 11或更高版本")]),a._v(" "),e("li",[a._v("具有sudo权限的用户")])]),a._v(" "),e("ol",[e("li",[e("p",[a._v("确保服务器满足以下要求：")]),a._v(" "),e("ul",[e("li",[a._v("内存：建议每个Kafka节点至少具有8GB的内存。")]),a._v(" "),e("li",[a._v("存储：根据预期的消息负载和保留期限，为Kafka节点提供足够的磁盘空间。")]),a._v(" "),e("li",[a._v("CPU：建议每个Kafka节点具有多个CPU核心以处理高吞吐量的消息流。")]),a._v(" "),e("li",[a._v("网络：确保服务器具有足够的网络带宽和稳定的网络连接。")])])]),a._v(" "),e("li",[e("p",[a._v("将用户"),e("code",[a._v("alinesno")]),a._v("添加到sudoers文件中，以便具有root权限。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤2-安装java-jdk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤2-安装java-jdk"}},[a._v("#")]),a._v(" 步骤2：安装Java JDK")]),a._v(" "),e("p",[a._v("Kafka需要Java JDK来运行。按照以下步骤安装Java JDK 11：")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("打开终端并执行以下命令以安装Java JDK 11：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo yum install java-11-openjdk-devel\n")])])])]),a._v(" "),e("li",[e("p",[a._v("安装完成后，验证Java JDK是否正确安装：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("java -version\n")])])]),e("p",[a._v("应该显示Java版本信息。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤3-下载和解压zookeeper"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤3-下载和解压zookeeper"}},[a._v("#")]),a._v(" 步骤3：下载和解压Zookeeper")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("打开终端并执行以下命令以下载Zookeeper：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("wget https://dlcdn.apache.org/zookeeper/zookeeper-3.8.2/apache-zookeeper-3.8.2-bin.tar.gz\n")])])])]),a._v(" "),e("li",[e("p",[a._v("下载完成后，执行以下命令解压Zookeeper：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("tar -xzf apache-zookeeper-3.8.2-bin.tar.gz\n")])])]),e("p",[a._v('解压后的文件将位于当前目录下的"apache-zookeeper-3.8.2-bin"文件夹中。')])])]),a._v(" "),e("h2",{attrs:{id:"步骤4-下载和解压kafka"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤4-下载和解压kafka"}},[a._v("#")]),a._v(" 步骤4：下载和解压Kafka")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("打开终端并执行以下命令以下载Kafka：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("wget https://downloads.apache.org/kafka/3.5.1/kafka_2.12-3.5.1.tgz\n")])])])]),a._v(" "),e("li",[e("p",[a._v("下载完成后，执行以下命令解压Kafka：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("tar -xzf kafka_2.12-3.5.1.tgz\n")])])]),e("p",[a._v('解压后的文件将位于当前目录下的"kafka_2.12-3.5.1"文件夹中。')])])]),a._v(" "),e("h2",{attrs:{id:"步骤5-配置zookeeper集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤5-配置zookeeper集群"}},[a._v("#")]),a._v(" 步骤5：配置Zookeeper集群")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("进入Zookeeper安装目录：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd apache-zookeeper-3.8.2-bin\n")])])])]),a._v(" "),e("li",[e("p",[a._v("复制示例配置文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cp conf/zoo_sample.cfg conf/zoo.cfg\n")])])])]),a._v(" "),e("li",[e("p",[a._v("编辑"),e("code",[a._v("conf/zoo.cfg")]),a._v("文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vi conf/zoo.cfg\n")])])])]),a._v(" "),e("li",[e("p",[a._v("在文件中，按需修改以下配置项：")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("dataDir")]),a._v("：Zookeeper数据目录的路径。")])]),a._v(" "),e("p",[a._v("保存并退出文件。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤6-启动zookeeper集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤6-启动zookeeper集群"}},[a._v("#")]),a._v(" 步骤6：启动Zookeeper集群")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("在新的终端窗口中，进入Zookeeper安装目录：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd apache-zookeeper-3.8.2-bin\n")])])])]),a._v(" "),e("li",[e("p",[a._v("启动Zookeeper服务：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("bin/zkServer.sh start\n")])])]),e("p",[a._v("执行此命令以启动Zookeeper集群。")])]),a._v(" "),e("li",[e("p",[a._v("如果您有多个Zookeeper节点，请在新的终端窗口中为每个节点重复步骤2。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤7-配置kafka集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤7-配置kafka集群"}},[a._v("#")]),a._v(" 步骤7：配置Kafka集群")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("进入Kafka安装目录：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd kafka_2.12-3.5.1\n")])])])]),a._v(" "),e("li",[e("p",[a._v("编辑"),e("code",[a._v("config/server.properties")]),a._v("文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vi config/server.properties\n")])])])]),a._v(" "),e("li",[e("p",[a._v("在文件中，按需修改以下配置项：")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("broker.id")]),a._v("：每个Kafka节点的唯一标识符。")]),a._v(" "),e("li",[e("code",[a._v("listeners")]),a._v("：Kafka监听器的主机名和端口号。")]),a._v(" "),e("li",[e("code",[a._v("advertised.listeners")]),a._v("：对外公开的Kafka监听器的主机名和端口号。")]),a._v(" "),e("li",[e("code",[a._v("zookeeper.connect")]),a._v("：Zookeeper集群的连接字符串。")])]),a._v(" "),e("p",[a._v("保存并退出文件。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤8-启动kafka集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤8-启动kafka集群"}},[a._v("#")]),a._v(" 步骤8：启动Kafka集群")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("在新的终端窗口中，进入Kafka安装目录：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd kafka_2.12-3.5.1\n")])])])]),a._v(" "),e("li",[e("p",[a._v("启动Kafka服务器：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("bin/kafka-server-start.sh config/server.properties\n")])])]),e("p",[a._v("执行此命令以启动第一个Kafka节点。")])]),a._v(" "),e("li",[e("p",[a._v("如果您有多个Kafka节点，请在新的终端窗口中为每个节点重复步骤2。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤9-验证kafka集群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤9-验证kafka集群"}},[a._v("#")]),a._v(" 步骤9：验证Kafka集群")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("在新的终端窗口中，进入Kafka安装目录：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd kafka_2.12-3.5.1\n")])])])]),a._v(" "),e("li",[e("p",[a._v('创建一个名为"test"的主题：')]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("bin/kafka-topics.sh --create --topic test --bootstrap-server localhost:9092 --replication-factor 1 --partitions 1\n")])])])]),a._v(" "),e("li",[e("p",[a._v('发布一些消息到"test"主题：')]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("bin/kafka-console-producer.sh --topic test --bootstrap-server localhost:9092\n")])])]),e("p",[a._v("输入一些消息并按Enter键，按ctrl+c结束")])]),a._v(" "),e("li",[e("p",[a._v('消费"test"主题的消息：')]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("bin/kafka-console-consumer.sh --topic test --from-beginning --bootstrap-server localhost:9092\n")])])]),e("p",[a._v("您应该能够看到之前发布的消息。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤10-kafka消息存储设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤10-kafka消息存储设置"}},[a._v("#")]),a._v(" 步骤10：Kafka消息存储设置")]),a._v(" "),e("p",[a._v("要将Kafka的消息存储天数设置为7天和消息最大大小设置为5M，请按照以下步骤进行配置：")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("进入Kafka安装目录：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd kafka_2.12-3.5.1\n")])])])]),a._v(" "),e("li",[e("p",[a._v("编辑"),e("code",[a._v("config/server.properties")]),a._v("文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vi config/server.properties\n")])])])]),a._v(" "),e("li",[e("p",[a._v("在文件中，找到以下配置项并进行相应的修改：")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("log.retention.hours")]),a._v("：将其设置为168（即7天）以设置消息的存储时间为7天。")]),a._v(" "),e("li",[e("code",[a._v("message.max.bytes")]),a._v("：将其设置为5242880（即5M）以设置消息的最大大小为5M。")])]),a._v(" "),e("p",[a._v("保存并退出文件。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤11-kafka副本配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤11-kafka副本配置"}},[a._v("#")]),a._v(" 步骤11：Kafka副本配置")]),a._v(" "),e("p",[a._v("要配置Kafka的副本配置为2个和集群节点数量为3个，请按照以下步骤进行配置：")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("编辑"),e("code",[a._v("config/server.properties")]),a._v("文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vi config/server.properties\n")])])])]),a._v(" "),e("li",[e("p",[a._v("在文件中，找到以下配置项并进行相应的修改：")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("default.replication.factor")]),a._v("：将其设置为2以配置每个主题的副本数为2。")]),a._v(" "),e("li",[e("code",[a._v("offsets.topic.replication.factor")]),a._v("：将其设置为2以配置Kafka内部使用的"),e("code",[a._v("__consumer_offsets")]),a._v("主题的副本数为2。")])]),a._v(" "),e("p",[a._v("保存并退出文件。")])]),a._v(" "),e("li",[e("p",[a._v("如果您要配置3个Kafka节点的集群，请确保复制以下文件和配置到其他节点上：")]),a._v(" "),e("ul",[e("li",[a._v("Kafka安装目录下的整个文件夹。")]),a._v(" "),e("li",[a._v("您在步骤5中修改的"),e("code",[a._v("config/server.properties")]),a._v("文件。")])]),a._v(" "),e("p",[a._v("这样，每个节点都将具有相同的配置，并且可以以集群模式运行。")])])]),a._v(" "),e("h2",{attrs:{id:"步骤12-kafka集成服务器service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤12-kafka集成服务器service"}},[a._v("#")]),a._v(" 步骤12：Kafka集成服务器service")]),a._v(" "),e("p",[a._v("以下是一个示例的Kafka集成服务器的service脚本，您可以使用它来启动、停止和重启Kafka服务，并使用systemctl来管理服务。")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("创建一个名为"),e("code",[a._v("kafka.service")]),a._v("的文件：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo vi /etc/systemd/system/kafka.service\n")])])])]),a._v(" "),e("li",[e("p",[a._v("将以下内容复制到文件中并保存：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v(' [Unit]\n Description=Apache Kafka Server\n Documentation=http://kafka.apache.org/documentation.html\n Requires=network.target\n After=network.target\n\n [Service]\n Type=simple\n User=alinesno\n Environment="JAVA_HOME=/usr/lib/jvm/java-11-openjdk"\n ExecStart=/home/alinesno/kafka_2.12-3.5.1/bin/kafka-server-start.sh /home/alinesno/kafka_2.12-3.5.1/config/server.properties\n ExecStop=/home/alinesno/kafka_2.12-3.5.1/bin/kafka-server-stop.sh\n Restart=on-failure\n\n [Install]\n WantedBy=multi-user.target\n')])])]),e("p",[a._v("请确保替换"),e("code",[a._v("/path/to/kafka_2.12-3.5.1")]),a._v("为实际的Kafka安装目录。")])]),a._v(" "),e("li",[e("p",[a._v("保存并退出文件。")])]),a._v(" "),e("li",[e("p",[a._v("重新加载systemd配置：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo systemctl daemon-reload\n")])])])])]),a._v(" "),e("p",[a._v("现在，您可以使用以下命令来启动、停止和重启Kafka服务：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("启动Kafka服务：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo systemctl start kafka\n")])])])]),a._v(" "),e("li",[e("p",[a._v("停止Kafka服务：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo systemctl stop kafka\n")])])])]),a._v(" "),e("li",[e("p",[a._v("重启Kafka服务：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sudo systemctl restart kafka\n")])])])])]),a._v(" "),e("h2",{attrs:{id:"结论"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[a._v("#")]),a._v(" 结论")]),a._v(" "),e("p",[e("strong",[a._v("建议进行更详细的配置和安全性设置，并使用适当的集群规模和复制因子来确保高可用性和数据冗余。")]),a._v(" 在生产环境中，您可以考虑以下配置和设置：")]),a._v(" "),e("ul",[e("li",[a._v("配置Kafka集群的复制因子（replication factor）为大于1的值，以实现数据冗余和高可用性。")]),a._v(" "),e("li",[a._v("配置适当的分区数和副本数，以满足您的业务需求和数据负载。")]),a._v(" "),e("li",[a._v("配置Kafka的安全性设置，如SSL/TLS加密、")])]),a._v(" "),e("p",[a._v("认证和访问控制，以保护Kafka集群免受未经授权的访问。")]),a._v(" "),e("p",[a._v("以下是一些进一步的配置和安全性设置的建议：")]),a._v(" "),e("ul",[e("li",[a._v("使用SSL/TLS加密：配置Kafka集群使用SSL/TLS加密来保护数据在传输过程中的安全性。")]),a._v(" "),e("li",[a._v("配置身份验证：使用Kafka支持的身份验证机制，如Kerberos、SSL客户端身份验证或SASL/PLAIN身份验证，以确保只有经过身份验证的用户可以访问和操作Kafka集群。")]),a._v(" "),e("li",[a._v("设置访问控制列表（ACLs）：使用Kafka的ACL功能限制访问和操作Kafka主题的权限，以确保只有授权的用户或应用程序可以读写特定的主题。")]),a._v(" "),e("li",[a._v("监控和日志记录：配置适当的监控和日志记录机制，以便及时发现和响应潜在的安全事件或故障。")]),a._v(" "),e("li",[a._v("定期备份和数据冗余：实施定期的备份策略，并确保在集群中有足够的数据冗余，以防止数据丢失。")])])])}),[],!1,null,null,null);e.default=v.exports}}]);