(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{512:function(_,v,s){"use strict";s.r(v);var e=s(9),t=Object(e.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"服务器配置文档"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#服务器配置文档"}},[_._v("#")]),_._v(" 服务器配置文档")]),_._v(" "),v("p",[_._v("本文档提供了一系列任务，用于配置服务器以满足特定需求。这些任务包括禁用系统swap、加载内核模块、设置系统参数、设置系统ulimits等。")]),_._v(" "),v("h2",{attrs:{id:"禁用系统swap"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#禁用系统swap"}},[_._v("#")]),_._v(" 禁用系统swap")]),_._v(" "),v("p",[_._v("为了禁用系统swap，执行以下步骤：")]),_._v(" "),v("ol",[v("li",[v("p",[_._v("执行以下命令禁用系统swap：")]),_._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("source /etc/profile; swapoff -a && sysctl -w vm.swappiness=0\n")])])])]),_._v(" "),v("li",[v("p",[_._v("删除fstab swap相关配置：")]),_._v(" "),v("p",[_._v("打开"),v("code",[_._v("/etc/fstab")]),_._v('文件并删除所有包含"swap"的行。')])]),_._v(" "),v("li",[v("p",[_._v("加载内核模块：")]),_._v(" "),v("p",[_._v("使用"),v("code",[_._v("modprobe")]),_._v("命令加载以下内核模块：")]),_._v(" "),v("ul",[v("li",[v("code",[_._v("br_netfilter")])]),_._v(" "),v("li",[v("code",[_._v("ip_vs")])]),_._v(" "),v("li",[v("code",[_._v("ip_vs_rr")])]),_._v(" "),v("li",[v("code",[_._v("ip_vs_wrr")])]),_._v(" "),v("li",[v("code",[_._v("ip_vs_sh")])]),_._v(" "),v("li",[v("code",[_._v("nf_conntrack")])])])]),_._v(" "),v("li",[v("p",[_._v("尝试加载nf_conntrack_ipv4：")]),_._v(" "),v("p",[_._v("执行以下命令尝试加载"),v("code",[_._v("nf_conntrack_ipv4")]),_._v("模块：")]),_._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v('modprobe nf_conntrack_ipv4 || echo "NoFound"\n')])])])]),_._v(" "),v("li",[v("p",[_._v("启用systemd自动加载模块服务：")]),_._v(" "),v("p",[_._v("执行以下命令以启用systemd自动加载模块服务：")]),_._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[_._v("service name=systemd-modules-load enabled=yes\n")])])])]),_._v(" "),v("li",[v("p",[_._v("增加内核模块开机加载配置：")]),_._v(" "),v("p",[_._v("将模板文件"),v("code",[_._v("10-k8s-modules.conf.j2")]),_._v("复制到"),v("code",[_._v("/etc/modules-load.d/")]),_._v("目录下，并重命名为"),v("code",[_._v("10-k8s-modules.conf")]),_._v("。")])])]),_._v(" "),v("h2",{attrs:{id:"设置系统参数for-k8s"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设置系统参数for-k8s"}},[_._v("#")]),_._v(" 设置系统参数for k8s")]),_._v(" "),v("p",[_._v("为了设置系统参数以满足k8s需求，执行以下步骤：")]),_._v(" "),v("ol",[v("li",[v("p",[_._v("将模板文件"),v("code",[_._v("95-k8s-sysctl.conf.j2")]),_._v("复制到"),v("code",[_._v("/etc/sysctl.d/")]),_._v("目录下，并重命名为"),v("code",[_._v("95-k8s-sysctl.conf")]),_._v("。")])]),_._v(" "),v("li",[v("p",[_._v("检查是否需要设置"),v("code",[_._v("fs.may_detach_mounts")]),_._v("参数：")]),_._v(" "),v("p",[_._v("执行以下命令检查"),v("code",[_._v("/proc/sys/fs/may_detach_mounts")]),_._v("文件是否存在。")])]),_._v(" "),v("li",[v("p",[_._v("当需要时，设置"),v("code",[_._v("fs.may_detach_mounts")]),_._v("为1：")]),_._v(" "),v("p",[_._v("执行以下命令将"),v("code",[_._v("fs.may_detach_mounts")]),_._v("设置为1，并重新加载系统参数。")])]),_._v(" "),v("li",[v("p",[_._v("检查是否需要设置"),v("code",[_._v("net.ipv4.tcp_tw_recycle")]),_._v("参数：")]),_._v(" "),v("p",[_._v("执行以下命令检查"),v("code",[_._v("/proc/sys/net/ipv4/tcp_tw_recycle")]),_._v("文件是否存在。")])]),_._v(" "),v("li",[v("p",[_._v("设置"),v("code",[_._v("tcp_tw_recycle")]),_._v("参数为0：")]),_._v(" "),v("p",[_._v("执行以下命令将"),v("code",[_._v("net.ipv4.tcp_tw_recycle")]),_._v("设置为0，并重新加载系统参数。")])]),_._v(" "),v("li",[v("p",[_._v("生效系统参数：")]),_._v(" "),v("p",[_._v("执行以下命令使系统参数生效。")])])]),_._v(" "),v("h2",{attrs:{id:"设置系统ulimits"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设置系统ulimits"}},[_._v("#")]),_._v(" 设置系统ulimits")]),_._v(" "),v("p",[_._v("为了设置系统ulimits，执行以下步骤：")]),_._v(" "),v("ol",[v("li",[v("p",[_._v("创建systemd配置目录：")]),_._v(" "),v("p",[_._v("执行以下命令创建"),v("code",[_._v("/etc/systemd/system.conf.d")]),_._v("目录。")])]),_._v(" "),v("li",[v("p",[_._v("将模板文件"),v("code",[_._v("30-k8s-ulimits.conf.j2")]),_._v("复制到"),v("code",[_._v("/etc/systemd/system.conf.d/")]),_._v("目录下，并重命名为"),v("code",[_._v("30-k8s-ulimits.conf")]),_._v("。")])])]),_._v(" "),v("h2",{attrs:{id:"把sctp列入内核模块黑名单"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#把sctp列入内核模块黑名单"}},[_._v("#")]),_._v(" 把SCTP列入内核模块黑名单")]),_._v(" "),v("p",[_._v("为了将SCTP列入内核模块黑名单，将文件"),v("code",[_._v("sctp.conf")]),_._v("复制到"),v("code",[_._v("/etc/modprobe.d/")]),_._v("目录下。")]),_._v(" "),v("p",[_._v("以上是服务器配置的文档，您可以根据实际需求执行这些任务来配置服务器。请注意，这只是一个示例文档，实际配置过程可能因环境和需求而有所不同。建议根据具体情况进行调整和参考相关文档。")])])}),[],!1,null,null,null);v.default=t.exports}}]);